(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var Editor, Floorplan, UndoRedo, addWallSimply, editor, findIntersection, getLengthAndRotation, orderIntersections, removeItemFrom, renderer, stage, subdivideExistingWall, subdivideNewWall, updateUICounter, _ref,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

_ref = require('./math'), getLengthAndRotation = _ref.getLengthAndRotation, findIntersection = _ref.findIntersection, orderIntersections = _ref.orderIntersections;

UndoRedo = require('./undoredo');

stage = null;

renderer = null;

removeItemFrom = function(array, item) {
  var index;
  index = array.indexOf(item);
  if (index > -1) {
    return array.splice(index, 1);
  }
};

Floorplan = (function() {
  function Floorplan() {
    this.walls = [];
  }

  Floorplan.prototype.addWall = function(wall) {
    var diff, intersection, intersections, w, _i, _len, _ref1;
    diff = [];
    intersections = [];
    _ref1 = this.walls;
    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
      w = _ref1[_i];
      intersection = findIntersection(wall.a, wall.b, w.a, w.b);
      if (intersection !== void 0) {
        intersections.push(intersection);
        subdivideExistingWall(intersection, w, diff);
      }
    }
    if (intersections.length === 0) {
      addWallSimply(wall, diff);
    } else {
      orderIntersections(wall, intersections);
      intersections.unshift(wall.a);
      intersections.push(wall.b);
      subdivideNewWall(intersections, diff);
    }
    return diff;
  };

  return Floorplan;

})();

addWallSimply = function(wall, diff) {
  return diff.push({
    operation: 'add',
    type: 'wall',
    obj: wall
  });
};

subdivideExistingWall = function(intersection, wall, diff) {
  var part1, part2;
  diff.push({
    operation: 'remove',
    type: 'wall',
    obj: wall
  });
  part1 = {
    a: wall.a,
    b: intersection
  };
  diff.push({
    operation: 'add',
    type: 'wall',
    obj: part1
  });
  part2 = {
    a: wall.b,
    b: intersection
  };
  diff.push({
    operation: 'add',
    type: 'wall',
    obj: part2
  });
  return diff;
};

subdivideNewWall = function(intersections, diff) {
  var i, part, s, _i, _len, _results;
  _results = [];
  for (i = _i = 0, _len = intersections.length; _i < _len; i = ++_i) {
    s = intersections[i];
    if (i >= intersections.length - 1) {
      continue;
    }
    part = {
      a: s,
      b: intersections[i + 1]
    };
    _results.push(diff.push({
      operation: 'add',
      type: 'wall',
      obj: part
    }));
  }
  return _results;
};

Editor = (function(_super) {
  __extends(Editor, _super);

  function Editor() {
    Editor.__super__.constructor.call(this);
    this.underlay = new PIXI.Graphics();
    this.underlay.hitArea = new PIXI.Rectangle(0, 0, 800, 600);
    this.underlay.interactive = true;
    this.addChild(this.underlay);
    this.tempGraphics = new PIXI.Graphics();
    this.addChild(this.tempGraphics);
    this.addUnderlayEvents(this.underlay);
    this.floorplan = new Floorplan();
    this.walls = [];
    this.undoRedo = new UndoRedo();
  }

  Editor.prototype.addUnderlayEvents = function(underlay) {
    underlay.mousedown = (function(_this) {
      return function(e) {
        _this.dragging = true;
        return _this.sp = {
          x: e.global.x,
          y: e.global.y
        };
      };
    })(this);
    underlay.mousemove = (function(_this) {
      return function(e) {
        if (_this.dragging) {
          _this.ep = {
            x: e.global.x,
            y: e.global.y
          };
          _this.tempGraphics.clear();
          _this.tempGraphics.lineStyle(10, 0xaa00aa);
          _this.tempGraphics.moveTo(_this.sp.x, _this.sp.y);
          _this.tempGraphics.lineTo(_this.ep.x, _this.ep.y);
          return renderer.render(stage);
        }
      };
    })(this);
    return underlay.mouseup = (function(_this) {
      return function(e) {
        _this.dragging = false;
        _this.tempGraphics.clear();
        _this.applyDiffs(_this.floorplan.addWall({
          a: _this.sp,
          b: _this.ep
        }));
        return renderer.render(stage);
      };
    })(this);
  };

  Editor.prototype.applyDiffs = function(diffs, putInUndoStack) {
    var diff, length, rotation, w, wall, wallToDelete, _i, _j, _len, _len1, _ref1, _ref2;
    if (putInUndoStack == null) {
      putInUndoStack = true;
    }
    if (putInUndoStack) {
      this.undoRedo.clearRedoFuture();
      this.undoRedo.constructUndoable(diffs);
    }
    for (_i = 0, _len = diffs.length; _i < _len; _i++) {
      diff = diffs[_i];
      if (diff.type === 'wall') {
        if (diff.operation === 'add') {
          wall = new PIXI.Graphics();
          wall.beginFill(0xffffff * Math.random());
          _ref1 = getLengthAndRotation(diff.obj.a, diff.obj.b), length = _ref1.length, rotation = _ref1.rotation;
          wall.drawRect(0, -5, length, 10);
          wall.position.x = diff.obj.a.x;
          wall.position.y = diff.obj.a.y;
          wall.rotation = rotation;
          wall.ref = diff.obj;
          this.addChild(wall);
          this.walls.push(wall);
          this.floorplan.walls.push(diff.obj);
        }
        if (diff.operation === 'remove') {
          wallToDelete = void 0;
          _ref2 = this.walls;
          for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
            w = _ref2[_j];
            if (w.ref === diff.obj) {
              wallToDelete = w;
              continue;
            }
          }
          this.removeChild(wallToDelete);
          removeItemFrom(this.walls, wallToDelete);
          removeItemFrom(this.floorplan.walls, wallToDelete.ref);
        }
      }
    }
    return updateUICounter(this.walls.length);
  };

  return Editor;

})(PIXI.DisplayObjectContainer);

updateUICounter = function(amount) {
  return document.getElementById('counter').innerHTML = '# walls: ' + amount;
};

stage = new PIXI.Stage(0x888888);

renderer = new PIXI.autoDetectRenderer();

editor = new Editor();

stage.addChild(editor);

document.body.appendChild(renderer.view);

window.onload = function() {
  return renderer.render(stage);
};

window.undo = function() {
  var d;
  if (editor.undoRedo.canUndo()) {
    d = editor.undoRedo.undo();
    editor.applyDiffs(d, false);
    return renderer.render(stage);
  }
};

window.redo = function() {
  var d;
  if (editor.undoRedo.canRedo()) {
    d = editor.undoRedo.redo();
    editor.applyDiffs(d, false);
    return renderer.render(stage);
  }
};

window.info = function() {
  return editor.undoRedo.info();
};


},{"./math":2,"./undoredo":3}],2:[function(require,module,exports){
var getLengthAndRotation;

module.exports.getLengthAndRotation = getLengthAndRotation = function(sp, ep) {
  return {
    middle: {
      x: (sp.x + ep.x) / 2,
      y: (sp.y + ep.y) / 2
    },
    length: Math.sqrt((sp.x - ep.x) * (sp.x - ep.x) + (sp.y - ep.y) * (sp.y - ep.y)),
    rotation: Math.atan2(ep.y - sp.y, ep.x - sp.x)
  };
};

module.exports.orderIntersections = function(line, intersections) {
  var compare, distanceTo;
  distanceTo = function(a, b) {
    return getLengthAndRotation(a, b).length;
  };
  compare = function(a, b) {
    if (distanceTo(a, line.a) < distanceTo(b, line.a)) {
      return -1;
    }
    if (distanceTo(a, line.a) > distanceTo(b, line.a)) {
      return 1;
    }
    return 0;
  };
  return intersections.sort(compare);
};

module.exports.findIntersection = function(a, b, a1, b1) {
  var denom, denomPositive, dx, dx1, dxa, dy, dy1, dya, intersection, s, t;
  dx = b.x - a.x;
  dy = b.y - a.y;
  dx1 = b1.x - a1.x;
  dy1 = b1.y - a1.y;
  denom = dx * dy1 - dx1 * dy;
  if (denom === 0) {
    return void 0;
  }
  denomPositive = denom > 0;
  dxa = a.x - a1.x;
  dya = a.y - a1.y;
  s = dx * dya - dy * dxa;
  if ((s < 0) === denomPositive) {
    return void 0;
  }
  t = dx1 * dya - dy1 * dxa;
  if ((t < 0) === denomPositive) {
    return void 0;
  }
  if ((s > denom) === denomPositive || (t > denom) === denomPositive) {
    return void 0;
  }
  t = t / denom;
  return intersection = {
    x: a.x + (t * dx),
    y: a.y + (t * dy)
  };
};


},{}],3:[function(require,module,exports){
var UndoRedo;

module.exports = UndoRedo = (function() {
  function UndoRedo() {
    this.undoStack = [];
    this.redoStack = [];
  }

  UndoRedo.prototype.constructUndoable = function(diffArray) {
    this.undoStack.push(this._negateAll(diffArray));
    return diffArray;
  };

  UndoRedo.prototype.constructRedoable = function(diffArray) {
    this.redoStack.push(this._negateAll(diffArray));
    return diffArray;
  };

  UndoRedo.prototype._negateAll = function(array) {
    var diff, negated, state, _i, _len;
    state = [];
    for (_i = 0, _len = array.length; _i < _len; _i++) {
      diff = array[_i];
      negated = this._negateDiff(diff);
      state.push(negated);
    }
    return state;
  };

  UndoRedo.prototype._negateDiff = function(diff) {
    var negatedDiff;
    negatedDiff = {};
    if (diff.operation === 'add') {
      negatedDiff.operation = 'remove';
    } else if (diff.operation === 'remove') {
      negatedDiff.operation = 'add';
    }
    negatedDiff.type = diff.type;
    negatedDiff.obj = diff.obj;
    return negatedDiff;
  };

  UndoRedo.prototype.info = function() {
    console.log('undo length: ', this.undoStack.length);
    console.log('redo length: ', this.redoStack.length);
    return console.log(JSON.stringify(this.undoStack));
  };

  UndoRedo.prototype.clearRedoFuture = function() {
    return this.redoStack = [];
  };

  UndoRedo.prototype.canUndo = function() {
    return this.undoStack.length > 0;
  };

  UndoRedo.prototype.canRedo = function() {
    return this.redoStack.length > 0;
  };

  UndoRedo.prototype.undo = function() {
    return this.constructRedoable(this.undoStack.pop());
  };

  UndoRedo.prototype.redo = function() {
    return this.constructUndoable(this.redoStack.pop());
  };

  return UndoRedo;

})();


},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyIvdXNyL2xvY2FsL2xpYi9ub2RlX21vZHVsZXMvd2F0Y2hpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi9Vc2Vycy9uaWtraWtvb2xlL1Byb2plY3RzL2xldmVsX2VkaXRvci9zb3VyY2UvbWFpbi5jb2ZmZWUiLCIvVXNlcnMvbmlra2lrb29sZS9Qcm9qZWN0cy9sZXZlbF9lZGl0b3Ivc291cmNlL21hdGguY29mZmVlIiwiL1VzZXJzL25pa2tpa29vbGUvUHJvamVjdHMvbGV2ZWxfZWRpdG9yL3NvdXJjZS91bmRvcmVkby5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQSxJQUFBLCtNQUFBO0VBQUE7aVNBQUE7O0FBQUEsT0FBK0QsT0FBQSxDQUFRLFFBQVIsQ0FBL0QsRUFBQyw0QkFBQSxvQkFBRCxFQUF1Qix3QkFBQSxnQkFBdkIsRUFBeUMsMEJBQUEsa0JBQXpDLENBQUE7O0FBQUEsUUFDQSxHQUFXLE9BQUEsQ0FBUSxZQUFSLENBRFgsQ0FBQTs7QUFBQSxLQUVBLEdBQVEsSUFGUixDQUFBOztBQUFBLFFBR0EsR0FBVyxJQUhYLENBQUE7O0FBQUEsY0FLQSxHQUFpQixTQUFDLEtBQUQsRUFBUSxJQUFSLEdBQUE7QUFDYixNQUFBLEtBQUE7QUFBQSxFQUFBLEtBQUEsR0FBUSxLQUFLLENBQUMsT0FBTixDQUFjLElBQWQsQ0FBUixDQUFBO0FBQ0EsRUFBQSxJQUFHLEtBQUEsR0FBUSxDQUFBLENBQVg7V0FDSSxLQUFLLENBQUMsTUFBTixDQUFhLEtBQWIsRUFBb0IsQ0FBcEIsRUFESjtHQUZhO0FBQUEsQ0FMakIsQ0FBQTs7QUFBQTtBQVdpQixFQUFBLG1CQUFBLEdBQUE7QUFDVCxJQUFBLElBQUMsQ0FBQSxLQUFELEdBQVMsRUFBVCxDQURTO0VBQUEsQ0FBYjs7QUFBQSxzQkFHQSxPQUFBLEdBQVMsU0FBQyxJQUFE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LENBQUMsTUFBWCxHQUFvQixFQURmO0VBQUEsQ0FwQ1QsQ0FBQTs7QUFBQSxxQkFzQ0EsT0FBQSxHQUFTLFNBQUEsR0FBQTtXQUNMLElBQUMsQ0FBQSxTQUFTLENBQUMsTUFBWCxHQUFvQixFQURmO0VBQUEsQ0F0Q1QsQ0FBQTs7QUFBQSxxQkF3Q0EsSUFBQSxHQUFNLFNBQUEsR0FBQTtXQUNGLElBQUMsQ0FBQSxpQkFBRCxDQUFtQixJQUFDLENBQUEsU0FBUyxDQUFDLEdBQVgsQ0FBQSxDQUFuQixFQURFO0VBQUEsQ0F4Q04sQ0FBQTs7QUFBQSxxQkEwQ0EsSUFBQSxHQUFNLFNBQUEsR0FBQTtXQUNGLElBQUMsQ0FBQSxpQkFBRCxDQUFtQixJQUFDLENBQUEsU0FBUyxDQUFDLEdBQVgsQ0FBQSxDQUFuQixFQURFO0VBQUEsQ0ExQ04sQ0FBQTs7a0JBQUE7O0lBREosQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKX12YXIgZj1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwoZi5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxmLGYuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwie2dldExlbmd0aEFuZFJvdGF0aW9uLCBmaW5kSW50ZXJzZWN0aW9uLCBvcmRlckludGVyc2VjdGlvbnN9ID0gcmVxdWlyZSAnLi9tYXRoJ1xuVW5kb1JlZG8gPSByZXF1aXJlICcuL3VuZG9yZWRvJ1xuc3RhZ2UgPSBudWxsXG5yZW5kZXJlciA9IG51bGwgICAgICAgICAgXG5cbnJlbW92ZUl0ZW1Gcm9tID0gKGFycmF5LCBpdGVtKSAtPlxuICAgIGluZGV4ID0gYXJyYXkuaW5kZXhPZiBpdGVtXG4gICAgaWYgaW5kZXggPiAtMVxuICAgICAgICBhcnJheS5zcGxpY2UoaW5kZXgsIDEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuY2xhc3MgRmxvb3JwbGFuXG4gICAgY29uc3RydWN0b3I6IC0+XG4gICAgICAgIEB3YWxscyA9IFtdXG5cbiAgICBhZGRXYWxsOiAod2FsbCkgLT5cbiAgICAgICAgZGlmZiA9IFtdXG4gICAgICAgIGludGVyc2VjdGlvbnMgPSBbXVxuICAgICAgICBmb3IgdyBpbiBAd2FsbHNcbiAgICAgICAgICAgIGludGVyc2VjdGlvbiA9IGZpbmRJbnRlcnNlY3Rpb24od2FsbC5hLCB3YWxsLmIsIHcuYSwgdy5iKVxuICAgICAgICAgICAgaWYgaW50ZXJzZWN0aW9uIGlzbnQgdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgaW50ZXJzZWN0aW9ucy5wdXNoIGludGVyc2VjdGlvblxuICAgICAgICAgICAgICAgIHN1YmRpdmlkZUV4aXN0aW5nV2FsbChpbnRlcnNlY3Rpb24sIHcsIGRpZmYpXG4gICAgICAgIGlmIGludGVyc2VjdGlvbnMubGVuZ3RoIGlzIDBcbiAgICAgICAgICAgIGFkZFdhbGxTaW1wbHkod2FsbCwgZGlmZilcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgb3JkZXJJbnRlcnNlY3Rpb25zKHdhbGwsIGludGVyc2VjdGlvbnMpXG4gICAgICAgICAgICBpbnRlcnNlY3Rpb25zLnVuc2hpZnQod2FsbC5hKVxuICAgICAgICAgICAgaW50ZXJzZWN0aW9ucy5wdXNoKHdhbGwuYilcbiAgICAgICAgICAgIHN1YmRpdmlkZU5ld1dhbGwoaW50ZXJzZWN0aW9ucywgZGlmZilcbiAgICAgICAgcmV0dXJuIGRpZmZcblxuYWRkV2FsbFNpbXBseSA9ICh3YWxsLCBkaWZmKSAtPlxuICAgIGRpZmYucHVzaCAoe29wZXJhdGlvbjonYWRkJywgdHlwZTond2FsbCcsIG9iajp3YWxsfSlcbiAgICAgICAgIFxuc3ViZGl2aWRlRXhpc3RpbmdXYWxsID0gKGludGVyc2VjdGlvbiwgd2FsbCwgZGlmZikgLT5cbiAgICBkaWZmLnB1c2ggKHtvcGVyYXRpb246J3JlbW92ZScsIHR5cGU6J3dhbGwnLCBvYmo6d2FsbH0pXG4gICAgcGFydDEgPSB7YTp3YWxsLmEsIGI6aW50ZXJzZWN0aW9ufVxuICAgIGRpZmYucHVzaCAoe29wZXJhdGlvbjonYWRkJywgdHlwZTond2FsbCcsIG9iajpwYXJ0MX0pXG4gICAgcGFydDIgPSB7YTp3YWxsLmIsIGI6aW50ZXJzZWN0aW9ufVxuICAgIGRpZmYucHVzaCAoe29wZXJhdGlvbjonYWRkJywgdHlwZTond2FsbCcsIG9iajpwYXJ0Mn0pXG4gICAgZGlmZlxuXG5zdWJkaXZpZGVOZXdXYWxsID0gKGludGVyc2VjdGlvbnMsIGRpZmYpIC0+XG4gICAgZm9yIHMsaSBpbiBpbnRlcnNlY3Rpb25zXG4gICAgICAgIGlmIGkgPj0gaW50ZXJzZWN0aW9ucy5sZW5ndGgtMVxuICAgICAgICAgICAgY29udGludWVcbiAgICAgICAgcGFydCA9IHthOnMsIGI6aW50ZXJzZWN0aW9uc1tpKzFdfVxuICAgICAgICBkaWZmLnB1c2ggKHtvcGVyYXRpb246J2FkZCcsIHR5cGU6J3dhbGwnLCBvYmo6cGFydH0pIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbmNsYXNzIEVkaXRvciBleHRlbmRzIFBJWEkuRGlzcGxheU9iamVjdENvbnRhaW5lclxuICAgIGNvbnN0cnVjdG9yOiAtPlxuICAgICAgICBzdXBlcigpXG4gICAgICAgIEB1bmRlcmxheSA9IG5ldyBQSVhJLkdyYXBoaWNzKClcbiAgICAgICAgQHVuZGVybGF5LmhpdEFyZWEgPSBuZXcgUElYSS5SZWN0YW5nbGUoMCwwLDgwMCw2MDApXG4gICAgICAgIEB1bmRlcmxheS5pbnRlcmFjdGl2ZSA9IHRydWVcbiAgICAgICAgQGFkZENoaWxkIEB1bmRlcmxheVxuICAgICAgICBAdGVtcEdyYXBoaWNzID0gbmV3IFBJWEkuR3JhcGhpY3MoKVxuICAgICAgICBAYWRkQ2hpbGQgQHRlbXBHcmFwaGljc1xuICAgICAgICBAYWRkVW5kZXJsYXlFdmVudHMoQHVuZGVybGF5KVxuICAgICAgICBAZmxvb3JwbGFuID0gbmV3IEZsb29ycGxhbigpXG4gICAgICAgIEB3YWxscyA9IFtdXG4gICAgICAgIEB1bmRvUmVkbyA9IG5ldyBVbmRvUmVkbygpXG4gICAgICAgIFxuICAgIGFkZFVuZGVybGF5RXZlbnRzOiAodW5kZXJsYXkpIC0+XG4gICAgICAgIHVuZGVybGF5Lm1vdXNlZG93biA9IChlKSA9PlxuICAgICAgICAgICAgQGRyYWdnaW5nID0gdHJ1ZVxuICAgICAgICAgICAgQHNwID0ge3g6ZS5nbG9iYWwueCwgeTplLmdsb2JhbC55fVxuXG4gICAgICAgIHVuZGVybGF5Lm1vdXNlbW92ZSA9IChlKSA9PlxuICAgICAgICAgICAgaWYgQGRyYWdnaW5nXG4gICAgICAgICAgICAgICAgQGVwID0ge3g6ZS5nbG9iYWwueCwgeTplLmdsb2JhbC55fVxuICAgICAgICAgICAgICAgIEB0ZW1wR3JhcGhpY3MuY2xlYXIoKVxuICAgICAgICAgICAgICAgIEB0ZW1wR3JhcGhpY3MubGluZVN0eWxlKDEwLDB4YWEwMGFhKVxuICAgICAgICAgICAgICAgIEB0ZW1wR3JhcGhpY3MubW92ZVRvKEBzcC54LCBAc3AueSlcbiAgICAgICAgICAgICAgICBAdGVtcEdyYXBoaWNzLmxpbmVUbyhAZXAueCwgQGVwLnkpXG4gICAgICAgICAgICAgICAgcmVuZGVyZXIucmVuZGVyIHN0YWdlXG4gICAgICAgICAgICAgICAgXG4gICAgICAgIHVuZGVybGF5Lm1vdXNldXAgPSAoZSkgPT5cbiAgICAgICAgICAgIEBkcmFnZ2luZyA9IGZhbHNlXG4gICAgICAgICAgICBAdGVtcEdyYXBoaWNzLmNsZWFyKClcbiAgICAgICAgICAgIEBhcHBseURpZmZzKEBmbG9vcnBsYW4uYWRkV2FsbCh7YTpAc3AsIGI6QGVwfSkpXG4gICAgICAgICAgICByZW5kZXJlci5yZW5kZXIgc3RhZ2VcblxuICAgIGFwcGx5RGlmZnM6IChkaWZmcywgcHV0SW5VbmRvU3RhY2sgPSB0cnVlKSAtPlxuICAgICAgICBpZiBwdXRJblVuZG9TdGFja1xuICAgICAgICAgICAgQHVuZG9SZWRvLmNsZWFyUmVkb0Z1dHVyZSgpICMga2lsbCAnYmFjayB0byB0aGUgZnV0dXJlIGFsdGVybmF0ZSB0aW1lbGluZSdcbiAgICAgICAgICAgIEB1bmRvUmVkby5jb25zdHJ1Y3RVbmRvYWJsZSBkaWZmc1xuXG4gICAgICAgIGZvciBkaWZmIGluIGRpZmZzXG4gICAgICAgICAgICBpZiBkaWZmLnR5cGUgaXMgJ3dhbGwnXG4gICAgICAgICAgICAgICAgaWYgZGlmZi5vcGVyYXRpb24gaXMgJ2FkZCdcbiAgICAgICAgICAgICAgICAgICAgd2FsbCA9IG5ldyBQSVhJLkdyYXBoaWNzKClcbiAgICAgICAgICAgICAgICAgICAgd2FsbC5iZWdpbkZpbGwoMHhmZmZmZmYgKiBNYXRoLnJhbmRvbSgpKVxuICAgICAgICAgICAgICAgICAgICB7bGVuZ3RoLCByb3RhdGlvbn0gPSBnZXRMZW5ndGhBbmRSb3RhdGlvbihkaWZmLm9iai5hLCBkaWZmLm9iai5iKVxuICAgICAgICAgICAgICAgICAgICB3YWxsLmRyYXdSZWN0KDAsIC01LCBsZW5ndGgsIDEwKVxuICAgICAgICAgICAgICAgICAgICB3YWxsLnBvc2l0aW9uLnggPSBkaWZmLm9iai5hLnhcbiAgICAgICAgICAgICAgICAgICAgd2FsbC5wb3NpdGlvbi55ID0gZGlmZi5vYmouYS55XG4gICAgICAgICAgICAgICAgICAgIHdhbGwucm90YXRpb24gPSByb3RhdGlvblxuICAgICAgICAgICAgICAgICAgICB3YWxsLnJlZiA9IGRpZmYub2JqXG4gICAgICAgICAgICAgICAgICAgIEBhZGRDaGlsZCB3YWxsXG4gICAgICAgICAgICAgICAgICAgIEB3YWxscy5wdXNoIHdhbGxcbiAgICAgICAgICAgICAgICAgICAgQGZsb29ycGxhbi53YWxscy5wdXNoIGRpZmYub2JqXG4gICAgICAgICAgICAgICAgaWYgZGlmZi5vcGVyYXRpb24gaXMgJ3JlbW92ZSdcbiAgICAgICAgICAgICAgICAgICAgd2FsbFRvRGVsZXRlID0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgIGZvciB3IGluIEB3YWxsc1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgdy5yZWYgaXMgZGlmZi5vYmpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWxsVG9EZWxldGUgPSB3XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcbiAgICAgICAgICAgICAgICAgICAgQHJlbW92ZUNoaWxkIHdhbGxUb0RlbGV0ZVxuICAgICAgICAgICAgICAgICAgICByZW1vdmVJdGVtRnJvbSBAd2FsbHMsIHdhbGxUb0RlbGV0ZVxuICAgICAgICAgICAgICAgICAgICByZW1vdmVJdGVtRnJvbSBAZmxvb3JwbGFuLndhbGxzLCB3YWxsVG9EZWxldGUucmVmXG4gICAgICAgIHVwZGF0ZVVJQ291bnRlciBAd2FsbHMubGVuZ3RoICAgICAgIFxuXG51cGRhdGVVSUNvdW50ZXIgPSAoYW1vdW50KSAtPlxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudGVyJykuaW5uZXJIVE1MID0gJyMgd2FsbHM6ICcrYW1vdW50XG5cblxuc3RhZ2UgPSBuZXcgUElYSS5TdGFnZSgweDg4ODg4OClcbnJlbmRlcmVyID0gbmV3IFBJWEkuYXV0b0RldGVjdFJlbmRlcmVyKClcbmVkaXRvciA9IG5ldyBFZGl0b3IoKVxuc3RhZ2UuYWRkQ2hpbGQgZWRpdG9yXG5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkIHJlbmRlcmVyLnZpZXdcblxuXG53aW5kb3cub25sb2FkID0gLT5cbiAgICByZW5kZXJlci5yZW5kZXIgc3RhZ2VcbiAgICBcbndpbmRvdy51bmRvID0gLT5cbiAgICBpZiBlZGl0b3IudW5kb1JlZG8uY2FuVW5kbygpXG4gICAgICAgIGQgPSBlZGl0b3IudW5kb1JlZG8udW5kbygpXG4gICAgICAgIGVkaXRvci5hcHBseURpZmZzIGQsIGZhbHNlXG4gICAgICAgIHJlbmRlcmVyLnJlbmRlciBzdGFnZVxuXG53aW5kb3cucmVkbyA9IC0+XG4gICAgaWYgZWRpdG9yLnVuZG9SZWRvLmNhblJlZG8oKVxuICAgICAgICBkID0gZWRpdG9yLnVuZG9SZWRvLnJlZG8oKVxuICAgICAgICBlZGl0b3IuYXBwbHlEaWZmcyBkLCBmYWxzZVxuICAgICAgICByZW5kZXJlci5yZW5kZXIgc3RhZ2Vcblxud2luZG93LmluZm8gPSAtPlxuICAgIGVkaXRvci51bmRvUmVkby5pbmZvKClcbiIsIm1vZHVsZS5leHBvcnRzLmdldExlbmd0aEFuZFJvdGF0aW9uID0gZ2V0TGVuZ3RoQW5kUm90YXRpb24gPSAoc3AsIGVwKSAtPlxuICAgIG1pZGRsZToge3g6KHNwLngrZXAueCkgLyAyLCB5OihzcC55K2VwLnkpIC8gMn0gIyBtaWRkbGUgbm90IG5lZWRlZCBhbnltb3JlXG4gICAgbGVuZ3RoOiBNYXRoLnNxcnQoKHNwLngtZXAueCkgKiAoc3AueC1lcC54KSArIChzcC55LWVwLnkpICogKHNwLnktZXAueSkpXG4gICAgcm90YXRpb246IE1hdGguYXRhbjIoZXAueS1zcC55LCBlcC54LXNwLngpXG5cbm1vZHVsZS5leHBvcnRzLm9yZGVySW50ZXJzZWN0aW9ucyA9IChsaW5lLCBpbnRlcnNlY3Rpb25zKSAtPlxuICAgICMgSSB3aWxsIG9yZGVyIHRoZSBpbnRlcnNlY3Rpb25zIHVzaW5nIGRpc3RhbmNlIGZyb20gbGluZS5hXG4gICAgZGlzdGFuY2VUbyA9IChhLGIpIC0+XG4gICAgICAgIGdldExlbmd0aEFuZFJvdGF0aW9uKGEsIGIpLmxlbmd0aFxuXG4gICAgY29tcGFyZSA9IChhLCBiKSAtPlxuICAgICAgICBpZiBkaXN0YW5jZVRvKGEsIGxpbmUuYSkgPCBkaXN0YW5jZVRvKGIsbGluZS5hKVxuICAgICAgICAgICAgcmV0dXJuIC0xXG4gICAgICAgIGlmIGRpc3RhbmNlVG8oYSwgbGluZS5hKSA+IGRpc3RhbmNlVG8oYiwgbGluZS5hKVxuICAgICAgICAgICAgcmV0dXJuIDFcbiAgICAgICAgcmV0dXJuIDBcbiAgICBpbnRlcnNlY3Rpb25zLnNvcnQoY29tcGFyZSlcblxubW9kdWxlLmV4cG9ydHMuZmluZEludGVyc2VjdGlvbiA9IChhLCBiLCBhMSwgYjEpIC0+XG4gICAgZHggPSBiLnggLSBhLnhcbiAgICBkeSA9IGIueSAtIGEueVxuICAgIGR4MSA9IGIxLnggLSBhMS54XG4gICAgZHkxID0gYjEueSAtIGExLnlcbiAgICBkZW5vbSA9IGR4ICogZHkxIC0gZHgxICogZHlcblxuICAgIGlmIGRlbm9tIGlzIDBcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZFxuXG4gICAgZGVub21Qb3NpdGl2ZSA9IGRlbm9tID4gMFxuXG4gICAgZHhhID0gYS54IC0gYTEueFxuICAgIGR5YSA9IGEueSAtIGExLnlcblxuICAgIHMgPSBkeCAqIGR5YSAtIGR5ICogZHhhXG5cbiAgICBpZiAocyA8IDApIGlzIGRlbm9tUG9zaXRpdmVcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZFxuXG4gICAgdCA9IGR4MSAqIGR5YSAtIGR5MSAqIGR4YVxuXG4gICAgaWYgKHQgPCAwKSBpcyBkZW5vbVBvc2l0aXZlXG4gICAgICAgIHJldHVybiB1bmRlZmluZWRcblxuICAgIGlmIChzID4gZGVub20pIGlzIGRlbm9tUG9zaXRpdmUgb3IgKHQgPiBkZW5vbSkgaXMgZGVub21Qb3NpdGl2ZVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkXG5cbiAgICB0ID0gdCAvIGRlbm9tXG4gICAgaW50ZXJzZWN0aW9uID0geDphLnggKyAodCAqIGR4KSwgeTphLnkgKyAodCAqIGR5KVxuIiwibW9kdWxlLmV4cG9ydHMgPSBjbGFzcyBVbmRvUmVkb1xuICAgIGNvbnN0cnVjdG9yOiAtPlxuICAgICAgICBAdW5kb1N0YWNrID0gW11cbiAgICAgICAgQHJlZG9TdGFjayA9IFtdXG5cbiAgICBjb25zdHJ1Y3RVbmRvYWJsZTogKGRpZmZBcnJheSkgLT5cbiAgICAgICAgQHVuZG9TdGFjay5wdXNoIEBfbmVnYXRlQWxsKGRpZmZBcnJheSlcbiAgICAgICAgZGlmZkFycmF5XG4gICAgICAgIFxuICAgIGNvbnN0cnVjdFJlZG9hYmxlOiAoZGlmZkFycmF5KSAtPlxuICAgICAgICBAcmVkb1N0YWNrLnB1c2ggQF9uZWdhdGVBbGwoZGlmZkFycmF5KVxuICAgICAgICBkaWZmQXJyYXlcbiAgICAgICAgIFxuICAgIF9uZWdhdGVBbGw6IChhcnJheSkgLT5cbiAgICAgICAgc3RhdGUgPSBbXVxuICAgICAgICBmb3IgZGlmZiBpbiBhcnJheVxuICAgICAgICAgICAgbmVnYXRlZCA9IEBfbmVnYXRlRGlmZihkaWZmKVxuICAgICAgICAgICAgc3RhdGUucHVzaCBuZWdhdGVkXG4gICAgICAgIHN0YXRlXG4gICAgX25lZ2F0ZURpZmY6IChkaWZmKSAtPlxuICAgICAgICBuZWdhdGVkRGlmZiA9IHt9XG4gICAgICAgIGlmIGRpZmYub3BlcmF0aW9uIGlzICdhZGQnXG4gICAgICAgICAgICBuZWdhdGVkRGlmZi5vcGVyYXRpb24gPSAncmVtb3ZlJ1xuICAgICAgICBlbHNlIGlmIGRpZmYub3BlcmF0aW9uIGlzICdyZW1vdmUnXG4gICAgICAgICAgICBuZWdhdGVkRGlmZi5vcGVyYXRpb24gPSAnYWRkJ1xuICAgICAgICBuZWdhdGVkRGlmZi50eXBlID0gZGlmZi50eXBlXG4gICAgICAgIG5lZ2F0ZWREaWZmLm9iaiA9IGRpZmYub2JqXG4gICAgICAgIG5lZ2F0ZWREaWZmXG5cbiAgICBpbmZvOiAtPlxuICAgICAgICBjb25zb2xlLmxvZyAndW5kbyBsZW5ndGg6ICcsQHVuZG9TdGFjay5sZW5ndGhcbiAgICAgICAgY29uc29sZS5sb2cgJ3JlZG8gbGVuZ3RoOiAnLEByZWRvU3RhY2subGVuZ3RoXG4gICAgICAgIGNvbnNvbGUubG9nIEpTT04uc3RyaW5naWZ5KEB1bmRvU3RhY2spXG5cbiAgICBjbGVhclJlZG9GdXR1cmU6IC0+XG4gICAgICAgIEByZWRvU3RhY2sgPSBbXVxuXG4gICAgY2FuVW5kbzogLT5cbiAgICAgICAgQHVuZG9TdGFjay5sZW5ndGggPiAwXG4gICAgY2FuUmVkbzogLT5cbiAgICAgICAgQHJlZG9TdGFjay5sZW5ndGggPiAwXG4gICAgdW5kbzogLT5cbiAgICAgICAgQGNvbnN0cnVjdFJlZG9hYmxlIEB1bmRvU3RhY2sucG9wKClcbiAgICByZWRvOiAtPlxuICAgICAgICBAY29uc3RydWN0VW5kb2FibGUgQHJlZG9TdGFjay5wb3AoKVxuIl19
